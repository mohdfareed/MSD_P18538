@page "/configuration"
@inject Services.ConfigurationService ConfigurationService
@using MudBlazor

<PageTitle>Configuration</PageTitle>
<MudText Typo="Typo.h3" Class="mb-3">Current Configuration</MudText>
<MudCard>
    <MudCardContent Style="display: flex; flex-direction: column-reverse; height: 300px; overflow-y: scroll;">

        @* Single confing setting *@
        <MudStack Row="true" AlignItems="AlignItems.End">
            @* Example of drop-down setting *@
            <MudSelect Label="Transcription Engine" @bind-Value="config.TranscriptionEngine">
                <MudSelectItem Value="@("GoogleSpeechToText")">Google Speech-to-Text</MudSelectItem>
                <MudSelectItem Value="@("AzureSpeechToText")">Azure Speech-to-Text</MudSelectItem>
                <MudSelectItem Value="@("AmazonTranscribe")">Amazon Transcribe</MudSelectItem>
            </MudSelect>
            @* Config info *@
            <MudTooltip Text="Engine used for transcribing audio data.">
                <MudIcon Icon="@Icons.Material.Filled.Info" />
            </MudTooltip>
        </MudStack>

    </MudCardContent>

    <MudCardActions>
        <MudButton Variant="Variant.Text" Color="Color.Primary" OnClick="ApplyChanges">Apply Changes</MudButton>
        <MudButton Variant="Variant.Text" Color="Color.Secondary" OnClick="OnInitializedAsync">Reset</MudButton>
    </MudCardActions>
</MudCard>



@code {
    private Models.Config config = new();

    private async Task LoadConfig()
    {
        @* config = await ConfigurationService.GetConfigAsync(); *@
        config = new Models.Config
            {
                TranscriptionEngine = "GoogleSpeechToText"
            };
    }

    private async Task ApplyChanges()
    {
        @* await ConfigurationService.SetConfigAsync(config); *@
        await LoadConfig();
    }

    override protected async Task OnInitializedAsync()
    {
        await LoadConfig();
    }
}
